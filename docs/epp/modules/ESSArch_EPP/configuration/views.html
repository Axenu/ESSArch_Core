<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ESSArch_EPP.configuration.views &#8212; ESSArch Preservation Platform 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../../../static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../static/jquery.js"></script>
    <script type="text/javascript" src="../../../static/underscore.js"></script>
    <script type="text/javascript" src="../../../static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ESSArch_EPP.configuration.views</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env /ESSArch/python27/bin/python</span>
<span class="c1"># -*- coding: UTF-8 -*-</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    ESSArch - ESSArch is an Electronic Archive system</span>
<span class="sd">    Copyright (C) 2010-2013  ES Solutions AB</span>

<span class="sd">    This program is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    This program is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License</span>
<span class="sd">    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="sd">    Contact information:</span>
<span class="sd">    Web - http://www.essolutions.se</span>
<span class="sd">    Email - essarch@essolutions.se</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="n">__majorversion__</span> <span class="o">=</span> <span class="s2">&quot;2.5&quot;</span>
<span class="n">__revision__</span> <span class="o">=</span> <span class="s2">&quot;$Revision$&quot;</span>
<span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;$Date$&quot;</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;$Author$&quot;</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">__majorversion__</span><span class="p">,</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[\D]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">__revision__</span><span class="p">))</span>

<span class="c1"># Create your views here.</span>
<span class="kn">from</span> <span class="nn">django.template</span> <span class="k">import</span> <span class="n">Context</span><span class="p">,</span> <span class="n">loader</span>
<span class="kn">from</span> <span class="nn">django.template</span> <span class="k">import</span> <span class="n">RequestContext</span> 
<span class="kn">from</span> <span class="nn">django.contrib.auth.models</span> <span class="k">import</span> <span class="n">User</span><span class="p">,</span> <span class="n">Group</span><span class="p">,</span> <span class="n">Permission</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="k">import</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">HttpResponseRedirect</span>
<span class="kn">from</span> <span class="nn">django</span> <span class="k">import</span> <span class="n">forms</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="k">import</span> <span class="n">render_to_response</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.decorators</span> <span class="k">import</span> <span class="n">login_required</span>
<span class="kn">from</span> <span class="nn">django.contrib.admin.views.decorators</span> <span class="k">import</span> <span class="n">staff_member_required</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth</span> <span class="k">import</span> <span class="n">logout</span>
<span class="kn">from</span> <span class="nn">django.contrib.auth.views</span> <span class="k">import</span> <span class="n">password_change</span> <span class="k">as</span> <span class="n">admin_password_change</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># own models etc</span>
<span class="kn">from</span> <span class="nn">configuration.models</span> <span class="k">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">SchemaProfile</span><span class="p">,</span> <span class="n">IPParameter</span><span class="p">,</span> <span class="n">Path</span>


<span class="nd">@login_required</span>
<div class="viewcode-block" id="index"><a class="viewcode-back" href="../../../ESSArch_EPP.configuration.html#ESSArch_EPP.configuration.views.index">[docs]</a><span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">RequestContext</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">c</span><span class="p">))</span></div>


<div class="viewcode-block" id="logout_view"><a class="viewcode-back" href="../../../ESSArch_EPP.configuration.html#ESSArch_EPP.configuration.views.logout_view">[docs]</a><span class="k">def</span> <span class="nf">logout_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">logout</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
    <span class="c1"># Redirect to a success page.</span>
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span> <span class="s1">&#39;/&#39;</span> <span class="p">)</span></div>


<span class="nd">@login_required</span>
<div class="viewcode-block" id="change_password"><a class="viewcode-back" href="../../../ESSArch_EPP.configuration.html#ESSArch_EPP.configuration.views.change_password">[docs]</a><span class="k">def</span> <span class="nf">change_password</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">admin_password_change</span><span class="p">(</span> <span class="n">request</span><span class="p">,</span> <span class="n">post_change_redirect</span><span class="o">=</span><span class="s2">&quot;/&quot;</span> <span class="p">)</span></div>


<span class="nd">@staff_member_required</span>
<div class="viewcode-block" id="createdefaultusers"><a class="viewcode-back" href="../../../ESSArch_EPP.configuration.html#ESSArch_EPP.configuration.views.createdefaultusers">[docs]</a><span class="k">def</span> <span class="nf">createdefaultusers</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="c1"># default users, groups and permissions</span>
    
    <span class="c1"># remove existing default users</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;usr&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="c1"># remove existing default groups</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zone&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">Group</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="c1"># permissions for default users</span>
    <span class="n">can_add_log_entry</span> <span class="o">=</span> <span class="n">Permission</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Can add log entry&#39;</span><span class="p">)</span>
    <span class="n">can_change_log_entry</span> <span class="o">=</span> <span class="n">Permission</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Can change log entry&#39;</span><span class="p">)</span>
    <span class="n">can_delete_log_entry</span> <span class="o">=</span> <span class="n">Permission</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Can delete log entry&#39;</span><span class="p">)</span>
    <span class="n">can_view_log_menu</span> <span class="o">=</span> <span class="n">Permission</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Can_view_log_menu&#39;</span><span class="p">)</span>
<span class="c1">#    can_view_ip_menu = Permission.objects.get(name=&#39;Can_view_ip_menu&#39;)</span>
<span class="c1">#    can_add_ip = Permission.objects.get(name=&#39;Can add information package&#39;)</span>
<span class="c1">#    can_change_ip = Permission.objects.get(name=&#39;Can change information package&#39;)</span>
<span class="c1">#    can_delete_ip = Permission.objects.get(name=&#39;Can delete information package&#39;)    </span>
    
    <span class="c1"># find out which zone</span>
    <span class="n">zone</span> <span class="o">=</span> <span class="n">Parameter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entity</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    
    <span class="c1"># create users and groups according to zone</span>
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;zone1&quot;</span> <span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;usr1&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s1">&#39;usr1&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;usr1&#39;</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zone1&#39;</span><span class="p">)</span>
        <span class="n">myuser</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mygroup</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="c1">#        mygroup.permissions.add(can_add_log_entry, can_change_log_entry, can_delete_log_entry, can_view_ip_menu, can_add_ip, can_change_ip, can_delete_ip)</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">can_add_log_entry</span><span class="p">,</span> <span class="n">can_change_log_entry</span><span class="p">,</span> <span class="n">can_delete_log_entry</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;zone2&quot;</span> <span class="p">:</span>            
        <span class="k">try</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;usr2&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s1">&#39;usr2&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;usr2&#39;</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zone2&#39;</span><span class="p">)</span>
        <span class="n">myuser</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mygroup</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="p">[</span><span class="n">can_add_log_entry</span><span class="p">,</span> <span class="n">can_change_log_entry</span><span class="p">,</span> <span class="n">can_delete_log_entry</span><span class="p">,</span> <span class="n">can_view_log_menu</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;zone3&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;usr3&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s1">&#39;usr3&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;usr3&#39;</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zone3&#39;</span><span class="p">)</span>
        <span class="n">myuser</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mygroup</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="p">[</span><span class="n">can_add_log_entry</span><span class="p">,</span> <span class="n">can_change_log_entry</span><span class="p">,</span> <span class="n">can_delete_log_entry</span><span class="p">]</span>
        
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;usr1&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s1">&#39;usr1&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;usr1&#39;</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zone1&#39;</span><span class="p">)</span>
        <span class="n">myuser</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mygroup</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="c1">#        mygroup.permissions.add(can_add_log_entry, can_change_log_entry, can_delete_log_entry, can_add_ip, can_change_ip, can_delete_ip, can_view_ip_menu,)</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">can_add_log_entry</span><span class="p">,</span> <span class="n">can_change_log_entry</span><span class="p">,</span> <span class="n">can_delete_log_entry</span><span class="p">,)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;usr2&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s1">&#39;usr2&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;usr2&#39;</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zone2&#39;</span><span class="p">)</span>
        <span class="n">myuser</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mygroup</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="p">[</span><span class="n">can_add_log_entry</span><span class="p">,</span> <span class="n">can_change_log_entry</span><span class="p">,</span> <span class="n">can_delete_log_entry</span><span class="p">,</span> <span class="n">can_view_log_menu</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;usr3&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">User</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="n">myuser</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span><span class="s1">&#39;usr3&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;usr3&#39;</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="p">,</span> <span class="n">created</span> <span class="o">=</span> <span class="n">Group</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Zone3&#39;</span><span class="p">)</span>
        <span class="n">myuser</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mygroup</span><span class="p">)</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">mygroup</span><span class="o">.</span><span class="n">permissions</span> <span class="o">=</span> <span class="p">[</span><span class="n">can_add_log_entry</span><span class="p">,</span> <span class="n">can_change_log_entry</span><span class="p">,</span> <span class="n">can_delete_log_entry</span><span class="p">]</span>
        
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span> <span class="s1">&#39;/admin/auth/user&#39;</span> <span class="p">)</span></div>
    

<span class="nd">@staff_member_required</span>
<div class="viewcode-block" id="installdefaultpaths"><a class="viewcode-back" href="../../../ESSArch_EPP.configuration.html#ESSArch_EPP.configuration.views.installdefaultpaths">[docs]</a><span class="k">def</span> <span class="nf">installdefaultpaths</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="c1"># default paths</span>
    
    <span class="c1"># First remove all existing data </span>
    <span class="n">Path</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="c1"># find out which zone</span>
    <span class="n">zone</span> <span class="o">=</span> <span class="n">Parameter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entity</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    
    <span class="c1"># create dictionaries for zone</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dct1</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path_prepare&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/prepare&#39;</span><span class="p">,</span>
            <span class="s1">&#39;path_delivery&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/delivery&#39;</span><span class="p">,</span>
            <span class="s1">&#39;path_expedition&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/expedition&#39;</span><span class="p">,</span>
            <span class="p">}</span>
    <span class="n">dct2</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path_expedition&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/expedition&#39;</span><span class="p">,</span>
            <span class="s1">&#39;path_gate&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/ioessarch&#39;</span><span class="p">,</span>
            <span class="p">}</span>
    <span class="n">dct3</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path_reception&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/reception&#39;</span><span class="p">,</span>
            <span class="s1">&#39;path_gate&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/ioessarch&#39;</span><span class="p">,</span>
            <span class="s1">&#39;path_work&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/work&#39;</span><span class="p">,</span>
            <span class="s1">&#39;path_control&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/control&#39;</span><span class="p">,</span>
            <span class="p">}</span>
    <span class="n">dctc</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;path_mimetypesdefinition&#39;</span><span class="p">:</span><span class="s1">&#39;/ESSArch/Tools/env/data&#39;</span><span class="p">,</span>
            <span class="p">}</span>

    <span class="c1"># set default logevents according to zone</span>
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;zone1&quot;</span> <span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dct1</span><span class="p">)</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dctc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;zone2&quot;</span> <span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dct2</span><span class="p">)</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dctc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;zone3&quot;</span> <span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dct3</span><span class="p">)</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dctc</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span> <span class="p">:</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dct1</span><span class="p">)</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dct2</span><span class="p">)</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dct3</span><span class="p">)</span>
        <span class="n">dct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dctc</span><span class="p">)</span>
    
    <span class="c1"># if zone is incorrect</span>
    <span class="k">if</span> <span class="n">dct</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span> <span class="s1">&#39;/admin/configuration&#39;</span> <span class="p">)</span>

    <span class="c1"># create according to model with two fields</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dct</span> <span class="p">:</span>
        <span class="nb">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;**&quot;</span><span class="p">,</span> <span class="n">key</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">le</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span> <span class="n">entity</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">dct</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">)</span>
            <span class="n">le</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span> <span class="s1">&#39;/admin/configuration&#39;</span> <span class="p">)</span></div>

<span class="nd">@staff_member_required</span>
<div class="viewcode-block" id="installdefaultschemaprofiles"><a class="viewcode-back" href="../../../ESSArch_EPP.configuration.html#ESSArch_EPP.configuration.views.installdefaultschemaprofiles">[docs]</a><span class="k">def</span> <span class="nf">installdefaultschemaprofiles</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="c1"># default schema profiles for Sweden and Norway</span>
    
    <span class="c1"># First remove all existing data </span>
    <span class="n">SchemaProfile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="c1"># find out which site_profile</span>
    <span class="n">site_profile</span> <span class="o">=</span> <span class="n">Parameter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entity</span><span class="o">=</span><span class="s2">&quot;site_profile&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

    <span class="c1"># create schema dictionaries per country SE/NO </span>
    <span class="k">if</span> <span class="n">site_profile</span> <span class="o">==</span> <span class="s2">&quot;SE&quot;</span> <span class="p">:</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span>
               <span class="s1">&#39;mets_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.loc.gov/METS/&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mets_schemalocation&#39;</span><span class="p">:</span> <span class="s1">&#39;http://xml.ra.se/METS/RA_METS_eARD.xsd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mets_profile&#39;</span><span class="p">:</span> <span class="s1">&#39;http://xml.ra.se/METS/RA_METS_eARD.xml&#39;</span><span class="p">,</span>
               <span class="s1">&#39;premis_namespace&#39;</span><span class="p">:</span><span class="s1">&#39;http://xml.ra.se/PREMIS&#39;</span><span class="p">,</span>
               <span class="s1">&#39;premis_schemalocation&#39;</span><span class="p">:</span><span class="s1">&#39;http://xml.ra.se/PREMIS/RA_PREMIS.xsd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;premis_version&#39;</span><span class="p">:</span><span class="s1">&#39;2.0&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mods_namespace&#39;</span><span class="p">:</span><span class="s1">&#39;http://www.loc.gov/mods/v3&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xlink_namespace&#39;</span><span class="p">:</span><span class="s1">&#39;http://www.w3.org/1999/xlink&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xsi_namespace&#39;</span><span class="p">:</span><span class="s1">&#39;http://www.w3.org/2001/XMLSchema-instance&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xsd_namespace&#39;</span><span class="p">:</span><span class="s1">&#39;http://www.w3.org/2001/XMLSchema&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mix_namespace&#39;</span><span class="p">:</span><span class="s1">&#39;http://xml.ra.se/MIX&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mix_schemalocation&#39;</span><span class="p">:</span><span class="s1">&#39;http://xml.ra.se/MIX/RA_MIX.xsd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;addml_namespace&#39;</span><span class="p">:</span><span class="s1">&#39;http://xml.ra.se/addml&#39;</span><span class="p">,</span>
               <span class="s1">&#39;addml_schemalocation&#39;</span><span class="p">:</span><span class="s1">&#39;http://xml.ra.se/addml/ra_addml.xsd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xhtml_namespace&#39;</span><span class="p">:</span><span class="s1">&#39;http://www.w3.org/1999/xhtml&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xhtml_schemalocation&#39;</span><span class="p">:</span><span class="s1">&#39;http://www.w3.org/MarkUp/SCHEMA/xhtml11.xsd&#39;</span>      
               <span class="p">}</span>

    <span class="k">if</span> <span class="n">site_profile</span> <span class="o">==</span> <span class="s2">&quot;NO&quot;</span> <span class="p">:</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span>
               <span class="s1">&#39;mets_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.loc.gov/METS/&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mets_schemalocation&#39;</span><span class="p">:</span> <span class="s1">&#39;http://xml.ra.se/METS/RA_METS_eARD.xsd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mets_profile&#39;</span><span class="p">:</span> <span class="s1">&#39;http://xml.ra.se/METS/RA_METS_eARD.xml&#39;</span><span class="p">,</span>
               <span class="s1">&#39;premis_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://arkivverket.no/standarder/PREMIS&#39;</span><span class="p">,</span>
               <span class="s1">&#39;premis_schemalocation&#39;</span><span class="p">:</span> <span class="s1">&#39;http://schema.arkivverket.no/PREMIS/v2.0/DIAS_PREMIS.xsd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;premis_version&#39;</span><span class="p">:</span> <span class="s1">&#39;2.0&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mods_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.loc.gov/mods/v3&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xlink_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.w3.org/1999/xlink&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xsi_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.w3.org/2001/XMLSchema-instance&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xsd_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.w3.org/2001/XMLSchema&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mix_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://xml.ra.se/MIX&#39;</span><span class="p">,</span>
               <span class="s1">&#39;mix_schemalocation&#39;</span><span class="p">:</span> <span class="s1">&#39;http://xml.ra.se/MIX/RA_MIX.xsd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;addml_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.arkivverket.no/addml&#39;</span><span class="p">,</span>
               <span class="s1">&#39;addml_schemalocation&#39;</span><span class="p">:</span> <span class="s1">&#39;http://xml.ra.se/addml/ra_addml.xsd&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xhtml_namespace&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.w3.org/1999/xhtml&#39;</span><span class="p">,</span>
               <span class="s1">&#39;xhtml_schemalocation&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.w3.org/MarkUp/SCHEMA/xhtml11.xsd&#39;</span>      
               <span class="p">}</span>

    <span class="c1"># create according to model with two fields</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dct</span> <span class="p">:</span>
        <span class="nb">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;**&quot;</span><span class="p">,</span> <span class="n">key</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">le</span> <span class="o">=</span> <span class="n">SchemaProfile</span><span class="p">(</span> <span class="n">entity</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">dct</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">)</span>
            <span class="n">le</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span> <span class="s1">&#39;/admin/configuration/schemaprofile&#39;</span> <span class="p">)</span></div>


<span class="nd">@staff_member_required</span>
<div class="viewcode-block" id="installdefaultparameters"><a class="viewcode-back" href="../../../ESSArch_EPP.configuration.html#ESSArch_EPP.configuration.views.installdefaultparameters">[docs]</a><span class="k">def</span> <span class="nf">installdefaultparameters</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="c1"># default config parameters</span>
    
    <span class="c1"># find out which zone, if none set one</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">zone</span> <span class="o">=</span> <span class="n">Parameter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">entity</span><span class="o">=</span><span class="s2">&quot;zone&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">zone</span> <span class="o">=</span> <span class="s2">&quot;zone1&quot;</span>
    <span class="k">if</span> <span class="n">zone</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">zone</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zone</span> <span class="o">=</span> <span class="s2">&quot;zone1&quot;</span>
            
    <span class="c1"># First remove all data </span>
    <span class="n">Parameter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="c1"># set default parameters according to zone</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span>
           <span class="s1">&#39;site_profile&#39;</span><span class="p">:</span><span class="s1">&#39;NO&#39;</span><span class="p">,</span>
           <span class="s1">&#39;zone&#39;</span><span class="p">:</span> <span class="n">zone</span> <span class="p">,</span>
           <span class="s1">&#39;templatefile_specification&#39;</span><span class="p">:</span><span class="s1">&#39;info.xml&#39;</span><span class="p">,</span>
           <span class="s1">&#39;templatefile_log&#39;</span><span class="p">:</span><span class="s1">&#39;log.xml&#39;</span><span class="p">,</span>
           <span class="p">}</span>
    
    <span class="c1"># create according to model with two fields</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dct</span> <span class="p">:</span>
        <span class="nb">print</span> <span class="o">&gt;&gt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="s2">&quot;**&quot;</span><span class="p">,</span> <span class="n">key</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">le</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span> <span class="n">entity</span><span class="o">=</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">dct</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">)</span>
            <span class="n">le</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="c1"># install default configuration</span>
    <span class="n">createdefaultusers</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>             <span class="c1"># default users, groups and permissions</span>
    <span class="n">installdefaultpaths</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>            <span class="c1"># default paths</span>
    <span class="n">installdefaultschemaprofiles</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>   <span class="c1"># default schema profiles for Sweden or Norway</span>
    <span class="n">installIPParameter</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>             <span class="c1"># default metadata for IP</span>
    
    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span> <span class="s1">&#39;/admin/configuration&#39;</span> <span class="p">)</span></div>


<span class="nd">@staff_member_required</span>
<div class="viewcode-block" id="installIPParameter"><a class="viewcode-back" href="../../../ESSArch_EPP.configuration.html#ESSArch_EPP.configuration.views.installIPParameter">[docs]</a><span class="k">def</span> <span class="nf">installIPParameter</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>  <span class="c1"># default metadata for IP</span>
    
    <span class="c1"># First remove all data </span>
    <span class="n">IPParameter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
    
    <span class="c1"># create dictionary for IP elements</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="p">{</span>
           <span class="s1">&#39;objid&#39;</span><span class="p">:</span><span class="s1">&#39;UUID:550e8400-e29b-41d4-a716-446655440004&#39;</span><span class="p">,</span>
           <span class="s1">&#39;label&#39;</span><span class="p">:</span><span class="s1">&#39;Example of SIP for delivery of personel information&#39;</span><span class="p">,</span>
           <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;SIP&#39;</span><span class="p">,</span>
           <span class="s1">&#39;createdate&#39;</span><span class="p">:</span><span class="s1">&#39;2012-04-26T12:45:00+01:00&#39;</span><span class="p">,</span>
           <span class="s1">&#39;recordstatus&#39;</span><span class="p">:</span><span class="s1">&#39;NEW&#39;</span><span class="p">,</span>
           <span class="s1">&#39;deliverytype&#39;</span><span class="p">:</span><span class="s1">&#39;ERMS&#39;</span><span class="p">,</span>
           <span class="s1">&#39;deliveryspecification&#39;</span><span class="p">:</span><span class="s1">&#39;FGS Personal, version 1&#39;</span><span class="p">,</span>
           <span class="s1">&#39;submissionagreement&#39;</span><span class="p">:</span><span class="s1">&#39;RA 13-2011/5329; 2012-04-12&#39;</span><span class="p">,</span>
           <span class="s1">&#39;previoussubmissionagreement&#39;</span><span class="p">:</span><span class="s1">&#39;FM 12-2387/12726, 2007-09-19&#39;</span><span class="p">,</span>
           <span class="s1">&#39;datasubmissionsession&#39;</span><span class="p">:</span><span class="s1">&#39;Submission, 2012-04-15 15:00&#39;</span><span class="p">,</span>
           <span class="s1">&#39;packagenumber&#39;</span><span class="p">:</span><span class="s1">&#39;SIP Number 2938&#39;</span><span class="p">,</span>
           <span class="s1">&#39;referencecode&#39;</span><span class="p">:</span><span class="s1">&#39;SE/RA/123456/24/P&#39;</span><span class="p">,</span>
           <span class="s1">&#39;previousreferencecode&#39;</span><span class="p">:</span><span class="s1">&#39;SE/FM/123/123.1/123.1.3&#39;</span><span class="p">,</span>
           <span class="s1">&#39;appraisal&#39;</span><span class="p">:</span><span class="s1">&#39;Yes&#39;</span><span class="p">,</span>
           <span class="s1">&#39;accessrestrict&#39;</span><span class="p">:</span><span class="s1">&#39;Secrecy and PUL&#39;</span><span class="p">,</span>
           <span class="s1">&#39;archivist_organization&#39;</span><span class="p">:</span><span class="s1">&#39;Government X&#39;</span><span class="p">,</span>
           <span class="s1">&#39;archivist_organization_id&#39;</span><span class="p">:</span><span class="s1">&#39;ORG:2010340987&#39;</span><span class="p">,</span>
           <span class="s1">&#39;archivist_organization_software&#39;</span><span class="p">:</span><span class="s1">&#39;HR Employed&#39;</span><span class="p">,</span>
           <span class="s1">&#39;archivist_organization_software_id&#39;</span><span class="p">:</span><span class="s1">&#39;5.0.34&#39;</span><span class="p">,</span>
           <span class="s1">&#39;creator_organization&#39;</span><span class="p">:</span><span class="s1">&#39;Government X, Dep Y&#39;</span><span class="p">,</span>
           <span class="s1">&#39;creator_organization_id&#39;</span><span class="p">:</span><span class="s1">&#39;ORG:2010340987&#39;</span><span class="p">,</span>
           <span class="s1">&#39;creator_individual&#39;</span><span class="p">:</span><span class="s1">&#39;Mike Oldfield&#39;</span><span class="p">,</span>
           <span class="s1">&#39;creator_individual_details&#39;</span><span class="p">:</span><span class="s1">&#39;+46 (0)8-12 34 56, Mike.Oldfield@company.se&#39;</span><span class="p">,</span>
           <span class="s1">&#39;creator_software&#39;</span><span class="p">:</span><span class="s1">&#39;Packageprogram Packager&#39;</span><span class="p">,</span>
           <span class="s1">&#39;creator_software_id&#39;</span><span class="p">:</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
           <span class="s1">&#39;editor_organization&#39;</span><span class="p">:</span><span class="s1">&#39;Consultancy Company&#39;</span><span class="p">,</span>
           <span class="s1">&#39;editor_organization_id&#39;</span><span class="p">:</span><span class="s1">&#39;ORG:2020345987&#39;</span><span class="p">,</span>
           <span class="s1">&#39;preservation_organization&#39;</span><span class="p">:</span><span class="s1">&#39;National Archives of X&#39;</span><span class="p">,</span>
           <span class="s1">&#39;preservation_organization_id&#39;</span><span class="p">:</span><span class="s1">&#39;ORG:2010340987&#39;</span><span class="p">,</span>
           <span class="s1">&#39;preservation_organization_software&#39;</span><span class="p">:</span><span class="s1">&#39;ESSArch&#39;</span><span class="p">,</span>
           <span class="s1">&#39;preservation_organization_software_id&#39;</span><span class="p">:</span><span class="s1">&#39;3.0.0&#39;</span><span class="p">,</span>
           <span class="s1">&#39;startdate&#39;</span><span class="p">:</span><span class="s1">&#39;2012-01-01&#39;</span><span class="p">,</span> <span class="c1">## kkkk</span>
           <span class="s1">&#39;enddate&#39;</span><span class="p">:</span><span class="s1">&#39;2012-12-30&#39;</span><span class="p">,</span>
           <span class="s1">&#39;aic_id&#39;</span><span class="p">:</span><span class="s1">&#39;e4d025bc-56b0-11e2-893f-002215836551&#39;</span><span class="p">,</span>
           <span class="s1">&#39;informationclass&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
           <span class="s1">&#39;projectname&#39;</span><span class="p">:</span><span class="s1">&#39;Scanning&#39;</span><span class="p">,</span>
           <span class="s1">&#39;policyid&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span>
           <span class="s1">&#39;receipt_email&#39;</span><span class="p">:</span><span class="s1">&#39;Mike.Oldfield@company.se&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_id&#39;</span><span class="p">:</span><span class="s1">&#39;ID550e8400-e29b-41d4-a716-4466554400bg&#39;</span><span class="p">,</span> <span class="c1">## kkkk</span>
           <span class="s1">&#39;file_name&#39;</span><span class="p">:</span><span class="s1">&#39;file:personalexport.xml&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_createdate&#39;</span><span class="p">:</span><span class="s1">&#39;2012-04-20T13:30:00,+01:00&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_mime_type&#39;</span><span class="p">:</span><span class="s1">&#39;text/xml&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_format&#39;</span><span class="p">:</span><span class="s1">&#39;PDF/A&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_format_size&#39;</span><span class="p">:</span><span class="s1">&#39;8765324&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_type&#39;</span><span class="p">:</span><span class="s1">&#39;Delivery file&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_checksum&#39;</span><span class="p">:</span><span class="s1">&#39;574b69cf71ceb5534c8a2547f5547d&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_checksum_type&#39;</span><span class="p">:</span><span class="s1">&#39;SHA-256&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_transform_type&#39;</span><span class="p">:</span><span class="s1">&#39;DES&#39;</span><span class="p">,</span>
           <span class="s1">&#39;file_transform_key&#39;</span><span class="p">:</span><span class="s1">&#39;574b69cf71ceb5534c8a2547f5547d&#39;</span><span class="p">,</span>
           <span class="p">}</span>

    <span class="c1">#print dict1.keys()</span>
    <span class="c1">#print dict1.values()</span>
    <span class="c1">#print dict1.items()</span>
    <span class="c1">#print tt3.items()</span>
    
    <span class="c1">#new_dict = {}</span>
    <span class="c1">#new_lst = []</span>
    
    <span class="c1">#new_dict.update(dict2)</span>
    <span class="c1">#new_dict.update(dict3)</span>
    <span class="c1">#print new_dict.items() </span>
    
    <span class="c1"># create according to model with many fields</span>
    <span class="n">IPParameter</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">**</span><span class="n">dct</span><span class="p">)</span>
    <span class="c1">#IPMetadata.objects.create(**dct1)  # create from dictionary</span>
    <span class="c1">#IPMetadata.objects.filter(id=1).update(**dct1)  # update from dictionary</span>

    <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span> <span class="s1">&#39;/admin/configuration&#39;</span> <span class="p">)</span></div>

<span class="c1">#def installdefaulttags(request): # default tags</span>
<span class="c1">#    </span>
<span class="c1">#    # First remove all data </span>
<span class="c1">#    Tags.objects.all().delete()</span>
<span class="c1">#</span>
<span class="c1">#    entityType_keys = {</span>
<span class="c1">#                       1:[&#39;ROLE&#39;, &#39;ARCHIVIST&#39;],</span>
<span class="c1">#                       2:[&#39;TYPE&#39;, &#39;ORGANIZATION&#39;],</span>
<span class="c1">#                       3:[&#39;LABEL&#39;, &#39;Ex&#39;],</span>
<span class="c1">#                       4:[&#39;PERIOD&#39;, &#39;2012-01-01 - 2012-12-31&#39;],</span>
<span class="c1">#                       5:[&#39;OBJTYPE&#39;, &#39;SIP&#39; ],</span>
<span class="c1">#                       6:[&#39;CREATEDATE&#39;,&#39;2012-12-14&#39;],</span>
<span class="c1">#                       }</span>
<span class="c1">#</span>
<span class="c1">#    for key in entityType_keys:</span>
<span class="c1">#        print &gt;&gt; sys.stderr, &quot;**&quot;, key</span>
<span class="c1">#        try:</span>
<span class="c1">#            le = Tags( tag=entityType_keys[key][0],</span>
<span class="c1">#                              value=entityType_keys[key][1] )</span>
<span class="c1">#            le.save()</span>
<span class="c1">#        except:</span>
<span class="c1">#            pass</span>
<span class="c1">#    </span>
<span class="c1">#    return HttpResponseRedirect( &#39;/admin/configuration&#39; )</span>


</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, ES Solutions.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
    </div>

    

    
  </body>
</html>